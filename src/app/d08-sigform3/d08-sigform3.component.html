<h1 class="title">Flight Details Form</h1>
<app-validation-errors [errors]="flightForm().errors()" />

<form>

  <!-- Flight -->
  <hr>
  <h4 class="subtitle is-4">Flight</h4>
  <!-- Id -->
  <div class="field">
    <label class="label">Id</label>
    <div class="control">
      <input
        class="input"
        [ngClass]="{'is-danger': flightForm.id().errors().length > 0}"
        [field]="flightForm.id"
        type="text"
        placeholder="Enter id"
      >
    </div>
    @if(flightForm.id().errors().length === 0) {
      <p class="help">The ID of the flight</p>
    } @else {
      <app-validation-errors [errors]="flightForm.id().errors()" />
    }
  </div>

  <!-- From -->
  <div class="field">
    <label class="label">From</label>
    <div class="control">
      <input
        class="input"
        [ngClass]="{'is-danger': flightForm.from().errors().length > 0}"
        [field]="flightForm.from"
        type="text"
        placeholder="Enter airport"
      >
    </div>
    @if(flightForm.from().errors().length === 0) {
      <p class="help">Starting airport</p>
    } @else {
      <app-validation-errors [errors]="flightForm.from().errors()" />
    }
    @if (flightForm.from().pending()) {
      <p>Waiting for Async Validation Result.....</p>
    }
  </div>

  <!-- To -->
  <div class="field">
    <label class="label">To</label>
    <div class="control">
      <input
        class="input"
        [ngClass]="{'is-danger': flightForm.to().errors().length > 0}"
        [field]="flightForm.to"
        type="text"
        placeholder="Enter airport"
      >
    </div>
    @if(flightForm.to().errors().length === 0) {
      <p class="help">Destination airport</p>
    } @else {
      <app-validation-errors [errors]="flightForm.to().errors()" />
    }
  </div>

  <!-- Delay -->
  <div class="field">
    <label class="label">Delay</label>
    <div class="control">
      <input
        class="input"
        [ngClass]="{'is-danger': flightForm.delay().errors().length > 0}"
        [field]="flightForm.delay"
        type="number"
        placeholder="Enter delay"
      >
    </div>
    @if(flightForm.delay().errors().length === 0) {
      <p class="help">Delay in minutes</p>
    } @else {
      <app-validation-errors [errors]="flightForm.delay().errors()" />
    }
  </div>

  <!-- Delayed -->
  <div class="field">
    <label class="checkbox">Delayed
      <input
        type="checkbox"
        [field]="flightForm.delayed"
      >
    </label>
  </div>

  <!-- Aircraft -->
  @let aircraftForm = flightForm.aircraft;
  <hr>
  <h4 class="subtitle is-4">Aircraft</h4>
  <!-- type -->
  <div class="field">
    <label class="label">Type</label>
    <div class="control">
      <input
        class="input"
        [ngClass]="{'is-danger': aircraftForm.type().errors().length > 0}"
        [field]="aircraftForm.type"
        type="number"
        placeholder="Aircraft Type"
      >
    </div>
    @if(aircraftForm.type().errors().length === 0) {
      <p class="help">Aircraft Type</p>
    } @else {
      <app-validation-errors [errors]="aircraftForm.type().errors()" />
    }
  </div>

  <!-- registration -->
  <div class="field">
    <label class="label">Registration</label>
    <div class="control">
      <input
        class="input"
        [ngClass]="{'is-danger': aircraftForm.registration().errors().length > 0}"
        [field]="aircraftForm.registration"
        type="number"
        placeholder="Aircraft Registration"
      >
    </div>
    @if(aircraftForm.registration().errors().length === 0) {
      <p class="help">Aircraft Registration</p>
    } @else {
      <app-validation-errors [errors]="aircraftForm.registration().errors()" />
    }
  </div>

  <!-- Prices -->
  @let pricesForm = flightForm.prices;
  <hr>
  <h4 class="subtitle is-4">Prices</h4>
  <app-validation-errors [errors]="pricesForm().errors()"/>

  <table class="table">
    <thead>
      <tr>
        <th>Flight Class</th>
        <th>Amount</th>
        <th></th>
      </tr>
    </thead>
    <tbody>
      @for(price of pricesForm; track price) {
        <tr>
          <td><input [field]="price.flightClass" /></td>
          <td><input [field]="price.amount" /></td>
          <td>
            <app-validation-errors [errors]="price().errorSummary()"/>
          </td>
        </tr>
      }
    </tbody>
  </table>

  <button
    class="button"
    (click)="addPrice()"
    type="button">
    Add
  </button>


</form>

<hr>
<p>
  <a href="https://www.angulararchitects.io/blog/all-about-angulars-new-signal-forms/">See https://www.angulararchitects.io/blog/all-about-angulars-new-signal-forms/</a>
</p>


